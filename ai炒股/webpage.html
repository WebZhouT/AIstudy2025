<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    // 假设你的文本文件位于服务器上的某个路径，例如 'data.txt'
    const filePath = '1.txt';

    // 使用 fetch API 异步读取文件
    fetch(filePath)
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.text();
      })
      .then(fileContent => {
        // 解析文件内容
        return parseStockData(fileContent);
      })
      .then(jsonData => {
        // 将解析后的 JSON 数据显示在页面上
        document.getElementById('output').textContent = JSON.stringify(jsonData, null, 4);
      })
      .catch(error => {
        console.error('Error fetching or parsing the file:', error);
      });

    function parseStockData (fileContent) {
      const parser = new DOMParser();
      const doc = parser.parseFromString(fileContent, 'text/html');

      const stockData = [];

      const rows = doc.querySelectorAll('.iwc-table-body tr');
      rows.forEach((row) => {
        const stockName = row.querySelector('.td-cell-box.graph a')?.textContent.trim() || '';
        const stockCode = row.querySelector('.td-cell-box:nth-child(3)')?.textContent.trim() || '';
        const industry = row.querySelector('.td-cell-box.alignLeft .splitLink')?.textContent.trim() || '';

        const data = {
          stockCode,
          stockName,
          industry
        };

        stockData.push(data);
      });

      return stockData;
    }
  </script>
</body>

</html>