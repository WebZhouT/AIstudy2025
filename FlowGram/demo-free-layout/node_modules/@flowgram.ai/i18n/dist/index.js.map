{"version":3,"sources":["../src/index.ts","../src/i18n/zh-CN.ts","../src/i18n/en-US.ts"],"sourcesContent":["import { I18n as I18nStore } from 'i18n-js';\nimport { Emitter } from '@flowgram.ai/utils';\n\ntype Scope = Readonly<string | string[]>;\n\ninterface TranslateOptions {\n  defaultValue?: any;\n  [key: string]: any;\n}\n\ninterface I18nLanguage {\n  languageId: string;\n  languageName?: string;\n  localizedLanguageName?: string;\n  contents: Record<string, string | string[]>;\n}\n\nimport zhCNLanguageDefault from './i18n/zh-CN';\nimport enUSLanguageDefault from './i18n/en-US';\n\nfunction getDefaultLanugage(): string {\n  if (typeof navigator !== 'object') return 'en-US';\n  const defaultLanguage = navigator.language;\n  if (defaultLanguage === 'en' || defaultLanguage === 'en-US') {\n    return 'en-US';\n  }\n  if (defaultLanguage === 'zh' || defaultLanguage === 'zh-CN') {\n    return 'zh-CN';\n  }\n  return defaultLanguage;\n}\nclass I18nImpl {\n  public i18n = new I18nStore();\n\n  private _onLanguageChangeEmitter = new Emitter<string>();\n\n  readonly onLanguageChange = this._onLanguageChangeEmitter.event;\n\n  constructor(languages: I18nLanguage[]) {\n    this.addLanguages(languages);\n    this.locale = getDefaultLanugage();\n    this.i18n.onChange(() => {\n      this._onLanguageChangeEmitter.fire(this.i18n.locale);\n    });\n  }\n\n  /**\n   * missing check\n   */\n  missingStrictMode = false;\n\n  /**\n   * @param key\n   * @param options\n   */\n  t(key: Scope, options?: TranslateOptions): string {\n    return this.i18n.t(key, {\n      defaultValue: this.missingStrictMode ? undefined : key,\n      ...options,\n    });\n  }\n\n  get locale(): string {\n    return this.i18n.locale;\n  }\n\n  set locale(locale: string) {\n    this.i18n.locale = locale;\n  }\n\n  addLanguages(newLanguage: I18nLanguage[]): void {\n    this.i18n.store(\n      newLanguage.reduce(\n        (dict, lang) =>\n          Object.assign(dict, {\n            [lang.languageId]: {\n              languageName: lang.languageName,\n              localizedLanguageName: lang.localizedLanguageName,\n              ...lang.contents,\n            },\n          }),\n        {}\n      )\n    );\n  }\n\n  addLanguage(language: I18nLanguage) {\n    this.addLanguages([language]);\n  }\n}\n\nconst I18n = new I18nImpl([enUSLanguageDefault, zhCNLanguageDefault]);\n\nexport { I18n, I18nLanguage };\n","export default {\n  languageId: 'zh-CN',\n  languageName: 'Chinese',\n  localizedLanguageName: '中文(中国)',\n  contents: {\n    Yes: '是',\n    No: '否',\n  },\n};\n","export default {\n  languageId: 'en-US',\n  languageName: 'English',\n  localizedLanguageName: 'English',\n  contents: {\n    Yes: 'Yes',\n    No: 'No',\n  },\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAkC;AAClC,mBAAwB;;;ACDxB,IAAO,gBAAQ;AAAA,EACb,YAAY;AAAA,EACZ,cAAc;AAAA,EACd,uBAAuB;AAAA,EACvB,UAAU;AAAA,IACR,KAAK;AAAA,IACL,IAAI;AAAA,EACN;AACF;;;ACRA,IAAO,gBAAQ;AAAA,EACb,YAAY;AAAA,EACZ,cAAc;AAAA,EACd,uBAAuB;AAAA,EACvB,UAAU;AAAA,IACR,KAAK;AAAA,IACL,IAAI;AAAA,EACN;AACF;;;AFYA,SAAS,qBAA6B;AACpC,MAAI,OAAO,cAAc,SAAU,QAAO;AAC1C,QAAM,kBAAkB,UAAU;AAClC,MAAI,oBAAoB,QAAQ,oBAAoB,SAAS;AAC3D,WAAO;AAAA,EACT;AACA,MAAI,oBAAoB,QAAQ,oBAAoB,SAAS;AAC3D,WAAO;AAAA,EACT;AACA,SAAO;AACT;AACA,IAAM,WAAN,MAAe;AAAA,EAOb,YAAY,WAA2B;AANvC,SAAO,OAAO,IAAI,eAAAA,KAAU;AAE5B,SAAQ,2BAA2B,IAAI,qBAAgB;AAEvD,SAAS,mBAAmB,KAAK,yBAAyB;AAa1D;AAAA;AAAA;AAAA,6BAAoB;AAVlB,SAAK,aAAa,SAAS;AAC3B,SAAK,SAAS,mBAAmB;AACjC,SAAK,KAAK,SAAS,MAAM;AACvB,WAAK,yBAAyB,KAAK,KAAK,KAAK,MAAM;AAAA,IACrD,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA;AAAA,EAWA,EAAE,KAAY,SAAoC;AAChD,WAAO,KAAK,KAAK,EAAE,KAAK;AAAA,MACtB,cAAc,KAAK,oBAAoB,SAAY;AAAA,MACnD,GAAG;AAAA,IACL,CAAC;AAAA,EACH;AAAA,EAEA,IAAI,SAAiB;AACnB,WAAO,KAAK,KAAK;AAAA,EACnB;AAAA,EAEA,IAAI,OAAO,QAAgB;AACzB,SAAK,KAAK,SAAS;AAAA,EACrB;AAAA,EAEA,aAAa,aAAmC;AAC9C,SAAK,KAAK;AAAA,MACR,YAAY;AAAA,QACV,CAAC,MAAM,SACL,OAAO,OAAO,MAAM;AAAA,UAClB,CAAC,KAAK,UAAU,GAAG;AAAA,YACjB,cAAc,KAAK;AAAA,YACnB,uBAAuB,KAAK;AAAA,YAC5B,GAAG,KAAK;AAAA,UACV;AAAA,QACF,CAAC;AAAA,QACH,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF;AAAA,EAEA,YAAY,UAAwB;AAClC,SAAK,aAAa,CAAC,QAAQ,CAAC;AAAA,EAC9B;AACF;AAEA,IAAM,OAAO,IAAI,SAAS,CAAC,eAAqB,aAAmB,CAAC;","names":["I18nStore"]}